## 跨域请求

浏览器会使用同源策略来来保护用户的安全，同源是指url中的协议、端口号、以及域名是完全相同的
> * 协议和端口号的问题，前端无法解决
> * 域名仅仅是通过URL首部来识别，不会根据域名对应的IP地址。

常用解决方法：

1. window.postMessage(H5新特性)
2. CORS方案
	* 让需要访问的服务器修改header:Access-Control-Allow-Origin的值为* 
3. 反向代理：例如使用Nginx
4. window.name + iframe 
	* 原理：页面重新加载时window.name的值不会改变
	* 支持非常长的 name 值（2MB）
5. document.domain+iframe 
	* 主域相同，子域不同
6. JSONP
	* 本质是使用get方式下载一个资源文件
	* 在跨域脚本中可以直接回调当前脚本的函数
	* 缺点：支持get不支持post，当传输json给后端时会报错


## Ajax和JSONP的区别
ajax和jsonp的调用方式很像，目的一样，都是请求url，然后把服务器返回的数据进行处理

1. 实质不同
	* ajax的核心是通过xmlHttpRequest获取非本页内容
	* jsonp的核心是动态添加script标签调用服务器提供的js脚本
2. 区别联系
	* 不在于是否跨域
	* ajax通过服务端代理一样跨域
	* jsonp也不并不排斥同域的数据的获取
3. jsonp是一种方式或者说非强制性的协议
4. jonp只支持get请求，ajax支持get和post请求

## 从地址栏输入URL开始到显示过程
1. 识别URL
	* 完整的URL包括协议、主机、资源路径。
	* 协议是从网络中获取资源的方式 
2. 查找本地hosts文件
	* 寻找url和ip的映射关系
	* 如果找到跳过步骤（3） 到步骤(4) 
3. DNS解析
	* 地址不是ip地址需要DNS(域名解析系统)解析成为ip地址
	* 若询问DNS服务器没有对应IP，则想上级DNS服务器询问，直到找到
4. 封装HTTP请求
	* 请求行 GET index.html HTTP/1.1
	* 请求头
	* 请求正文 
5. 通过三次握手建立TCP连接
	* 第一次握手syn=1
	* 第二次握手syn=1，ack=1
	* 第三次握手ack=1 
6. 发送请求
7. 响应请求
8. TCP四次挥手
	* 第一次挥手 客户端发送FIN=1 表示自己已经没有数据可以发送了，但是仍然可以接受数据。 
	* 第二次挥手 服务端发送ASK=1 表明接受到了客户端关闭连接的请求，但还没有准备好关闭连接。
	* 第三次挥手 服务端发送FIN=1 发送结束连接请求
	* 第四次挥手 客户端发送一个ASK=1 
9. 浏览器渲染页面

## 常见的http状态码
* 1xx 信息性状态码 表示临时响应并需要请求者继续执行操作的状态代码
* 2xx 成功性状态码
	*  `200` 成功
	*  `204` 表示请求已成功处理，但是没有内容返回
* 3xx 重定向状态码
	* `301` 永久重定向
	* `302` 临时重定向
	* `304` Not Modified 原来缓存的东西可以继续使用  
* 4xx 客户端错误状态码
	* `400` bad request 表示请求报文存在语法错误或参数错误，服务器不理解 
	* `401` 未授权  需要用户名和密码
	* `403` 禁止访问
	* `404` not found
	* `405`  方法不允许
* 5xx 服务端错误状态码
	* `500` 服务器内部问题
	* `501` 未实现某个功能

## HTTP方法
* `GET`方法请求一个指定资源的表示形式. 使用GET的请求应该只被用于获取数据. 


* `HEAD`方法请求一个与GET请求的响应相同的响应，但没有响应体.
* `POST`方法用于将实体提交到指定的资源，通常导致状态或服务器上的副作用的更改.
* `PUT`方法用请求有效载荷替换目标资源的所有当前表示。


* `CONNECT`方法建立一个到由目标资源标识的服务器的隧道。
* `TRACE`方法沿着到目标资源的路径执行一个消息环回测试。
* `OPTIONS`方法用于描述目标资源的通信选项。

## 浏览器缓存
* `Expires ` 缓存过期时间，用来指定资源到期的时间，是服务器端的具体的时间点


* `Cache-Control` 与Expires的作用一致，都是指明当前资源的有效期,只不过Cache-Control的选择更多，设置更细致，如果同时设置的话，其优先级高于Expires。 不是具体时间，是相对时间


* `Last-Modified/If-Modified-Since` 服务器端文件的最后修改时间


* `Etag/If-None-Match`   根据实体内容生成一段hash字符串，标识资源的状态，由服务端产生。

使用缓存流程:

![](img/1.png)